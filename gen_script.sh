#!/bin/bash


cd "/cygdrive/c/Users/secerdan/SimplicityStudio/v5_workspace_12/ot-rcp-base/gecko_sdk_4.4.3/protocol/openthread/libs" 

/cygdrive/c/SiliconLabs/SimplicityStudio/v5/developer/toolchains/gnu_arm/12.2.rel1_2023.7/bin/arm-none-eabi-ar.exe -x libsl_openthread_efr32mg2x_gcc.a

cp sl_openthread.o "/cygdrive/c/Users/secerdan/SimplicityStudio/v5_workspace_12/ot-rcp-base/GNU ARM v12.2.1 - Default"  

cd -

cd "/cygdrive/c/Users/secerdan/SimplicityStudio/v5_workspace_12/ot-rcp-base/GNU ARM v12.2.1 - Default"

rm -f rcptemp.a rcp.a
file_to_change=("./gecko_sdk_4.4.3/protocol/openthread/platform-abstraction/efr32/alarm.o" "./gecko_sdk_4.4.3/protocol/openthread/platform-abstraction/efr32/crypto.o" "./gecko_sdk_4.4.3/protocol/openthread/platform-abstraction/efr32/diag.o" "./gecko_sdk_4.4.3/protocol/openthread/platform-abstraction/efr32/entropy.o" "./gecko_sdk_4.4.3/protocol/openthread/platform-abstraction/efr32/flash.o" "./gecko_sdk_4.4.3/protocol/openthread/platform-abstraction/efr32/ieee802154-packet-utils.o" "./gecko_sdk_4.4.3/protocol/openthread/platform-abstraction/efr32/memory.o" "./gecko_sdk_4.4.3/protocol/openthread/platform-abstraction/efr32/misc.o" "./gecko_sdk_4.4.3/protocol/openthread/platform-abstraction/efr32/radio_extension.o" "./gecko_sdk_4.4.3/protocol/openthread/platform-abstraction/efr32/startup-gcc.o" "./gecko_sdk_4.4.3/protocol/openthread/platform-abstraction/efr32/uartdrv_uart.o" "./gecko_sdk_4.4.3/protocol/openthread/src/core/vendor_extension.o" "./gecko_sdk_4.4.3/protocol/openthread/src/legacy_hal/crash_handler.o" "./gecko_sdk_4.4.3/protocol/openthread/src/legacy_hal/diagnostic.o" "./gecko_sdk_4.4.3/util/third_party/openthread/examples/apps/ncp/ncp.o" "./gecko_sdk_4.4.3/util/third_party/openthread/examples/platforms/utils/debug_uart.o" "./gecko_sdk_4.4.3/util/third_party/openthread/examples/platforms/utils/link_metrics.o" "./gecko_sdk_4.4.3/util/third_party/openthread/examples/platforms/utils/mac_frame.o" "./gecko_sdk_4.4.3/util/third_party/openthread/examples/platforms/utils/settings_ram.o" "./gecko_sdk_4.4.3/util/third_party/openthread/examples/platforms/utils/uart_rtt.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/api/diags_api.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/api/error_api.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/api/instance_api.o"  "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/api/logging_api.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/api/random_noncrypto_api.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/api/tasklet_api.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/common/binary_search.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/common/error.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/common/frame_builder.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/common/log.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/common/random.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/common/string.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/common/tasklet.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/common/timer.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/common/uptime.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/crypto/aes_ccm.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/crypto/aes_ecb.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/crypto/crypto_platform.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/crypto/storage.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/diags/factory_diags.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/instance/instance.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/mac/link_raw.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/api/link_raw_api.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/mac/mac_frame.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/mac/mac_types.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/mac/sub_mac.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/mac/sub_mac_callbacks.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/radio/radio.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/radio/radio_callbacks.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/radio/radio_platform.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/thread/link_quality.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/utils/parse_cmdline.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/core/utils/power_calibration.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/lib/hdlc/hdlc.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/lib/spinel/radio_spinel.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/lib/spinel/spinel.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/lib/spinel/spinel_buffer.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/lib/spinel/spinel_decoder.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/lib/spinel/spinel_encoder.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/ncp/changed_props_set.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/ncp/ncp_base.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/ncp/ncp_base_dispatcher.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/ncp/ncp_base_ftd.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/ncp/ncp_base_mtd.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/ncp/ncp_base_radio.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/ncp/ncp_hdlc.o" "./gecko_sdk_4.4.3/util/third_party/openthread/src/ncp/ncp_spi.o" "./sl_openthread.o" "./gecko_sdk_4.4.3/platform/security/sl_component/sl_mbedtls_support/src/se_jpake.o" "./gecko_sdk_4.4.3/platform/security/sl_component/sl_mbedtls_support/src/sl_entropy_hardware.o" "./gecko_sdk_4.4.3/platform/security/sl_component/sl_psa_driver/src/sli_psa_trng.o" )


echo "${file_to_change[@]}"

/cygdrive/c/SiliconLabs/SimplicityStudio/v5/developer/toolchains/gnu_arm/12.2.rel1_2023.7/bin/arm-none-eabi-ar.exe rcs rcptemp.a "./app.o" "${file_to_change[@]}"

/cygdrive/c/SiliconLabs/SimplicityStudio/v5/developer/toolchains/gnu_arm/12.2.rel1_2023.7/bin/arm-none-eabi-objcopy.exe --target elf32-littlearm  --prefix-symbols=rcp_ rcptemp.a rcptemp.a
/cygdrive/c/SiliconLabs/SimplicityStudio/v5/developer/toolchains/gnu_arm/12.2.rel1_2023.7/bin/arm-none-eabi-objcopy.exe --target elf32-littlearm  --redefine-syms="./../symbol_list.txt" rcptemp.a rcp.a

cp rcp.a /cygdrive/c/Users/secerdan/SimplicityStudio/v5_workspace_12/MatterLight_ThreadRcp_isp

cd -
